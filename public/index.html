<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    // EBBŐL CSAK EGYETLEN DARAB LEGYEN A TELJES FÁJLBAN:
    const firebaseConfig = {
        apiKey: "AIzaSyAQkoqTNUiJlXJeCOgZ_PrVjafgRdj65UA",
        authDomain: "sajatmesenger.firebaseapp.com",
        projectId: "sajatmesenger",
        storageBucket: "sajatmesenger.firebasestorage.app",
        messagingSenderId: "916403691764",
        appId: "1:916403691764:web:51fd4ec82de42c63917ea1",
        measurementId: "G-BYNSFK4FBL"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    window.register = () => {
        const email = document.getElementById('email').value;
        const pass = document.getElementById('password').value;
        if (!email || pass.length < 6) return alert("Email és min. 6 karakteres jelszó kell!");
        createUserWithEmailAndPassword(auth, email, pass)
            .then(() => alert("Sikeres regisztráció!"))
            .catch(err => alert("Hiba: " + err.message));
    };

    window.login = () => {
        const email = document.getElementById('email').value;
        const pass = document.getElementById('password').value;
        signInWithEmailAndPassword(auth, email, pass).catch(err => alert("Hiba: " + err.message));
    };

    window.logout = () => signOut(auth);

    onAuthStateChanged(auth, (user) => {
        if (user) {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('chat-screen').style.display = 'flex';
            document.getElementById('user-email').innerText = user.email;
            joinRoom('kozponti-szoba');
        } else {
            document.getElementById('login-screen').style.display = 'flex';
            document.getElementById('chat-screen').style.display = 'none';
        }
    });
</script>
